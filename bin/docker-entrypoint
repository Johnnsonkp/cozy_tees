#!/bin/bash -e

# Add any container initialization steps here

# Run database migrations (only in production)
if [ "$RAILS_ENV" = "production" ]; then
  echo "Running database migrations..."
  ./bin/rails db:migrate
  
  echo "Ensuring assets directory exists..."
  mkdir -p public/packs
  
  echo "Compiling webpack assets..."
  yarn install --check-files
  ./bin/webpack
  
  echo "Compiling Rails assets..."
  ./bin/rails assets:precompile
fi

exec "${@}"
